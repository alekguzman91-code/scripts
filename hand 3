local signal = require(script:WaitForChild'ScriptConnection').new

local fakeEvent = {}

function fakeEvent.new()
	local conn = {
		_connections={};
		_yield={};
	}
	
	setmetatable(conn,{__index=fakeEvent})
	
	return conn;
end

function fakeEvent:fire(...)
	self._yield={};
	for i = 1,#self._connections do
		local connection = self._connections[i]
		coroutine.wrap(function(...) connection.Function(#connection.Args>0 and unpack(connection.Args) or ...) end)(...)
	end	
end

function fakeEvent:disconnect(event)
	for i = 1,#self._connections do
		if(self._connections[i]==event)then
			table.remove(self._connections,i)
		end
	end
end

function fakeEvent:connect(func,...)
	local obj = signal(self,func,...)
	table.insert(self._connections,obj)
	return obj
end

function fakeEvent:wait()
	local guid = tostring(function() end):sub(13)
	self._yield[guid]=true;
	repeat wait() until self._yield[guid]~=true
	self._yield[guid]=nil;
end

fakeEvent.Fire=fakeEvent.fire;
fakeEvent.Connect=fakeEvent.connect;
fakeEvent.Wait=fakeEvent.wait;

setmetatable(fakeEvent,{__call=fakeEvent.new})
return fakeEvent;
